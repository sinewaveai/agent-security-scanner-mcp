rules:
  # ============================================================================
  # AWS SECRETS
  # ============================================================================
  - id: generic.secrets.security.aws-access-key-id
    languages: [generic]
    severity: ERROR
    message: "AWS Access Key ID detected. Remove and rotate immediately."
    patterns:
      - "(AKIA|ABIA|ACCA|ASIA)[0-9A-Z]{16}"
    metadata:
      cwe: "CWE-798"
      owasp: "A07:2021 - Identification and Authentication Failures"
      confidence: HIGH
      references:
        - https://semgrep.dev/r/generic.secrets.security.detected-aws-access-key-id

  - id: generic.secrets.security.aws-secret-access-key
    languages: [generic]
    severity: ERROR
    message: "AWS Secret Access Key detected. Remove and rotate immediately."
    patterns:
      - "(?i)(aws_secret_access_key|aws_secret_key|secret_access_key)\\s*[:=]\\s*[\"']?[A-Za-z0-9/+]{40}[\"']?"
    metadata:
      cwe: "CWE-798"
      owasp: "A07:2021 - Identification and Authentication Failures"
      confidence: HIGH
      references:
        - https://semgrep.dev/r/generic.secrets.security.detected-aws-secret-access-key

  # ============================================================================
  # GITHUB TOKENS
  # ============================================================================
  - id: generic.secrets.security.github-pat
    languages: [generic]
    severity: ERROR
    message: "GitHub Personal Access Token detected. Remove and revoke immediately."
    patterns:
      - "ghp_[A-Za-z0-9]{36}"
      - "github_pat_[A-Za-z0-9]{22}_[A-Za-z0-9]{59}"
    metadata:
      cwe: "CWE-798"
      owasp: "A07:2021 - Identification and Authentication Failures"
      confidence: HIGH
      references:
        - https://semgrep.dev/r/generic.secrets.security.detected-github-pat

  - id: generic.secrets.security.github-oauth
    languages: [generic]
    severity: ERROR
    message: "GitHub OAuth Token detected. Remove and revoke immediately."
    patterns:
      - "gho_[A-Za-z0-9]{36}"
    metadata:
      cwe: "CWE-798"
      owasp: "A07:2021 - Identification and Authentication Failures"
      confidence: HIGH
      references:
        - https://semgrep.dev/r/generic.secrets.security.detected-github-oauth

  - id: generic.secrets.security.github-app-token
    languages: [generic]
    severity: ERROR
    message: "GitHub App Token detected. Remove and revoke immediately."
    patterns:
      - "ghu_[A-Za-z0-9]{36}"
      - "ghs_[A-Za-z0-9]{36}"
    metadata:
      cwe: "CWE-798"
      owasp: "A07:2021 - Identification and Authentication Failures"
      confidence: HIGH
      references:
        - https://semgrep.dev/r/generic.secrets.security.detected-github-app-token

  # ============================================================================
  # STRIPE KEYS
  # ============================================================================
  - id: generic.secrets.security.stripe-api-key
    languages: [generic]
    severity: ERROR
    message: "Stripe API Key detected. Remove and rotate immediately."
    patterns:
      - "sk_live_[A-Za-z0-9]{24,}"
      - "sk_test_[A-Za-z0-9]{24,}"
      - "rk_live_[A-Za-z0-9]{24,}"
      - "rk_test_[A-Za-z0-9]{24,}"
    metadata:
      cwe: "CWE-798"
      owasp: "A07:2021 - Identification and Authentication Failures"
      confidence: HIGH
      references:
        - https://semgrep.dev/r/generic.secrets.security.detected-stripe-api-key

  # ============================================================================
  # OPENAI / AI API KEYS
  # ============================================================================
  - id: generic.secrets.security.openai-api-key
    languages: [generic]
    severity: ERROR
    message: "OpenAI API Key detected. Remove and rotate immediately."
    patterns:
      - "sk-[A-Za-z0-9]{48}"
      - "sk-proj-[A-Za-z0-9_-]{48,}"
    metadata:
      cwe: "CWE-798"
      owasp: "A07:2021 - Identification and Authentication Failures"
      confidence: HIGH
      references:
        - https://semgrep.dev/r/generic.secrets.security.detected-openai-api-key

  # ============================================================================
  # GOOGLE / GCP SECRETS
  # ============================================================================
  - id: generic.secrets.security.gcp-api-key
    languages: [generic]
    severity: ERROR
    message: "Google Cloud API Key detected. Remove and rotate immediately."
    patterns:
      - "AIza[A-Za-z0-9_-]{35}"
    metadata:
      cwe: "CWE-798"
      owasp: "A07:2021 - Identification and Authentication Failures"
      confidence: HIGH
      references:
        - https://semgrep.dev/r/generic.secrets.security.detected-gcp-api-key

  - id: generic.secrets.security.gcp-service-account
    languages: [generic]
    severity: ERROR
    message: "GCP Service Account key detected. Remove and rotate immediately."
    patterns:
      - "\"type\"\\s*:\\s*\"service_account\""
      - "\"private_key\"\\s*:\\s*\"-----BEGIN"
    metadata:
      cwe: "CWE-798"
      owasp: "A07:2021 - Identification and Authentication Failures"
      confidence: HIGH
      references:
        - https://semgrep.dev/r/generic.secrets.security.detected-gcp-service-account

  # ============================================================================
  # AZURE SECRETS
  # ============================================================================
  - id: generic.secrets.security.azure-storage-key
    languages: [generic]
    severity: ERROR
    message: "Azure Storage Account Key detected. Remove and rotate immediately."
    patterns:
      - "(?i)AccountKey\\s*=\\s*[A-Za-z0-9+/=]{88}"
      - "DefaultEndpointsProtocol=https;AccountName=[^;]+;AccountKey=[A-Za-z0-9+/=]{88}"
    metadata:
      cwe: "CWE-798"
      owasp: "A07:2021 - Identification and Authentication Failures"
      confidence: HIGH
      references:
        - https://semgrep.dev/r/generic.secrets.security.detected-azure-storage-key

  # ============================================================================
  # SLACK TOKENS
  # ============================================================================
  - id: generic.secrets.security.slack-token
    languages: [generic]
    severity: ERROR
    message: "Slack Token detected. Remove and revoke immediately."
    patterns:
      - "xoxb-[0-9]{10,}-[0-9]{10,}-[A-Za-z0-9]{24}"
      - "xoxp-[0-9]{10,}-[0-9]{10,}-[0-9]{10,}-[a-f0-9]{32}"
      - "xoxa-[0-9]{10,}-[0-9]{10,}-[A-Za-z0-9]{24}"
      - "xoxr-[0-9]{10,}-[A-Za-z0-9]{24}"
    metadata:
      cwe: "CWE-798"
      owasp: "A07:2021 - Identification and Authentication Failures"
      confidence: HIGH
      references:
        - https://semgrep.dev/r/generic.secrets.security.detected-slack-token

  - id: generic.secrets.security.slack-webhook
    languages: [generic]
    severity: ERROR
    message: "Slack Webhook URL detected. Remove and regenerate."
    patterns:
      - "https://hooks\\.slack\\.com/services/T[A-Z0-9]+/B[A-Z0-9]+/[A-Za-z0-9]+"
    metadata:
      cwe: "CWE-798"
      owasp: "A07:2021 - Identification and Authentication Failures"
      confidence: HIGH
      references:
        - https://semgrep.dev/r/generic.secrets.security.detected-slack-webhook

  # ============================================================================
  # PRIVATE KEYS
  # ============================================================================
  - id: generic.secrets.security.private-key-rsa
    languages: [generic]
    severity: ERROR
    message: "RSA Private Key detected. Remove from code immediately."
    patterns:
      - "-----BEGIN RSA PRIVATE KEY-----"
      - "-----BEGIN PRIVATE KEY-----"
      - "-----BEGIN EC PRIVATE KEY-----"
      - "-----BEGIN DSA PRIVATE KEY-----"
      - "-----BEGIN OPENSSH PRIVATE KEY-----"
    metadata:
      cwe: "CWE-798"
      owasp: "A07:2021 - Identification and Authentication Failures"
      confidence: HIGH
      references:
        - https://semgrep.dev/r/generic.secrets.security.detected-private-key

  # ============================================================================
  # JWT SECRETS
  # ============================================================================
  - id: generic.secrets.security.jwt-token
    languages: [generic]
    severity: WARNING
    message: "JWT token detected in code. Ensure tokens are not hardcoded."
    patterns:
      - "eyJ[A-Za-z0-9_-]+\\.eyJ[A-Za-z0-9_-]+\\.[A-Za-z0-9_-]+"
    metadata:
      cwe: "CWE-798"
      owasp: "A07:2021 - Identification and Authentication Failures"
      confidence: MEDIUM
      references:
        - https://semgrep.dev/r/generic.secrets.security.detected-jwt-token

  # ============================================================================
  # DATABASE CREDENTIALS
  # ============================================================================
  - id: generic.secrets.security.database-url
    languages: [generic]
    severity: ERROR
    message: "Database connection string with credentials detected. Use environment variables."
    patterns:
      - "(?i)(mysql|postgres|postgresql|mongodb|redis|mssql)://[^:]+:[^@]+@"
      - "(?i)mongodb\\+srv://[^:]+:[^@]+@"
    metadata:
      cwe: "CWE-798"
      owasp: "A07:2021 - Identification and Authentication Failures"
      confidence: HIGH
      references:
        - https://semgrep.dev/r/generic.secrets.security.detected-database-url

  # ============================================================================
  # TWILIO
  # ============================================================================
  - id: generic.secrets.security.twilio-api-key
    languages: [generic]
    severity: ERROR
    message: "Twilio API Key detected. Remove and rotate immediately."
    patterns:
      - "SK[a-f0-9]{32}"
      - "(?i)twilio[_-]?(auth[_-]?token|api[_-]?key)\\s*[:=]\\s*[\"']?[a-f0-9]{32}[\"']?"
    metadata:
      cwe: "CWE-798"
      owasp: "A07:2021 - Identification and Authentication Failures"
      confidence: HIGH
      references:
        - https://semgrep.dev/r/generic.secrets.security.detected-twilio-api-key

  # ============================================================================
  # SENDGRID
  # ============================================================================
  - id: generic.secrets.security.sendgrid-api-key
    languages: [generic]
    severity: ERROR
    message: "SendGrid API Key detected. Remove and rotate immediately."
    patterns:
      - "SG\\.[A-Za-z0-9_-]{22}\\.[A-Za-z0-9_-]{43}"
    metadata:
      cwe: "CWE-798"
      owasp: "A07:2021 - Identification and Authentication Failures"
      confidence: HIGH
      references:
        - https://semgrep.dev/r/generic.secrets.security.detected-sendgrid-api-key

  # ============================================================================
  # MAILCHIMP
  # ============================================================================
  - id: generic.secrets.security.mailchimp-api-key
    languages: [generic]
    severity: ERROR
    message: "Mailchimp API Key detected. Remove and rotate immediately."
    patterns:
      - "[a-f0-9]{32}-us[0-9]{1,2}"
    metadata:
      cwe: "CWE-798"
      owasp: "A07:2021 - Identification and Authentication Failures"
      confidence: HIGH
      references:
        - https://semgrep.dev/r/generic.secrets.security.detected-mailchimp-api-key

  # ============================================================================
  # HEROKU
  # ============================================================================
  - id: generic.secrets.security.heroku-api-key
    languages: [generic]
    severity: ERROR
    message: "Heroku API Key detected. Remove and rotate immediately."
    patterns:
      - "(?i)heroku[_-]?(api[_-]?key|auth[_-]?token)\\s*[:=]\\s*[\"']?[a-f0-9-]{36}[\"']?"
    metadata:
      cwe: "CWE-798"
      owasp: "A07:2021 - Identification and Authentication Failures"
      confidence: HIGH
      references:
        - https://semgrep.dev/r/generic.secrets.security.detected-heroku-api-key

  # ============================================================================
  # NPM TOKEN
  # ============================================================================
  - id: generic.secrets.security.npm-token
    languages: [generic]
    severity: ERROR
    message: "NPM Token detected. Remove and revoke immediately."
    patterns:
      - "npm_[A-Za-z0-9]{36}"
      - "//registry\\.npmjs\\.org/:_authToken=[A-Za-z0-9-]+"
    metadata:
      cwe: "CWE-798"
      owasp: "A07:2021 - Identification and Authentication Failures"
      confidence: HIGH
      references:
        - https://semgrep.dev/r/generic.secrets.security.detected-npm-token

  # ============================================================================
  # PYPI TOKEN
  # ============================================================================
  - id: generic.secrets.security.pypi-token
    languages: [generic]
    severity: ERROR
    message: "PyPI Token detected. Remove and revoke immediately."
    patterns:
      - "pypi-[A-Za-z0-9_-]{100,}"
    metadata:
      cwe: "CWE-798"
      owasp: "A07:2021 - Identification and Authentication Failures"
      confidence: HIGH
      references:
        - https://semgrep.dev/r/generic.secrets.security.detected-pypi-token

  # ============================================================================
  # DISCORD
  # ============================================================================
  - id: generic.secrets.security.discord-token
    languages: [generic]
    severity: ERROR
    message: "Discord Token detected. Remove and regenerate immediately."
    patterns:
      - "[MN][A-Za-z0-9]{23,}\\.[A-Za-z0-9_-]{6}\\.[A-Za-z0-9_-]{27}"
      - "(?i)discord[_-]?(token|webhook)\\s*[:=]\\s*[\"']?[A-Za-z0-9._-]+[\"']?"
    metadata:
      cwe: "CWE-798"
      owasp: "A07:2021 - Identification and Authentication Failures"
      confidence: HIGH
      references:
        - https://semgrep.dev/r/generic.secrets.security.detected-discord-token

  # ============================================================================
  # GENERIC PATTERNS
  # ============================================================================
  - id: generic.secrets.security.hardcoded-password
    languages: [generic]
    severity: ERROR
    message: "Hardcoded password detected. Use environment variables or a secrets manager."
    patterns:
      - "(?i)(password|passwd|pwd)\\s*[:=]\\s*[\"'][^\"']{6,}[\"']"
    metadata:
      cwe: "CWE-798"
      owasp: "A07:2021 - Identification and Authentication Failures"
      confidence: MEDIUM
      references:
        - https://semgrep.dev/r/generic.secrets.security.hardcoded-password

  - id: generic.secrets.security.hardcoded-api-key
    languages: [generic]
    severity: ERROR
    message: "Hardcoded API key detected. Use environment variables."
    patterns:
      - "(?i)(api[_-]?key|apikey)\\s*[:=]\\s*[\"'][A-Za-z0-9_-]{16,}[\"']"
      - "(?i)(secret[_-]?key|secretkey)\\s*[:=]\\s*[\"'][A-Za-z0-9_-]{16,}[\"']"
      - "(?i)(auth[_-]?token|authtoken)\\s*[:=]\\s*[\"'][A-Za-z0-9_-]{16,}[\"']"
      - "(?i)(access[_-]?token|accesstoken)\\s*[:=]\\s*[\"'][A-Za-z0-9_-]{16,}[\"']"
    metadata:
      cwe: "CWE-798"
      owasp: "A07:2021 - Identification and Authentication Failures"
      confidence: HIGH
      references:
        - https://semgrep.dev/r/generic.secrets.security.hardcoded-api-key

  # ============================================================================
  # SHOPIFY
  # ============================================================================
  - id: generic.secrets.security.shopify-token
    languages: [generic]
    severity: ERROR
    message: "Shopify Token detected. Remove and rotate immediately."
    patterns:
      - "shpat_[a-fA-F0-9]{32}"
      - "shpca_[a-fA-F0-9]{32}"
      - "shppa_[a-fA-F0-9]{32}"
    metadata:
      cwe: "CWE-798"
      owasp: "A07:2021 - Identification and Authentication Failures"
      confidence: HIGH
      references:
        - https://semgrep.dev/r/generic.secrets.security.detected-shopify-token

  # ============================================================================
  # FACEBOOK
  # ============================================================================
  - id: generic.secrets.security.facebook-token
    languages: [generic]
    severity: ERROR
    message: "Facebook Access Token detected. Remove and revoke immediately."
    patterns:
      - "EAA[A-Za-z0-9]{100,}"
    metadata:
      cwe: "CWE-798"
      owasp: "A07:2021 - Identification and Authentication Failures"
      confidence: HIGH
      references:
        - https://semgrep.dev/r/generic.secrets.security.detected-facebook-token

  # ============================================================================
  # TWITTER
  # ============================================================================
  - id: generic.secrets.security.twitter-bearer-token
    languages: [generic]
    severity: ERROR
    message: "Twitter Bearer Token detected. Remove and regenerate immediately."
    patterns:
      - "AAAAAAAAAAAAAAAAAAAAAA[A-Za-z0-9%]+"
    metadata:
      cwe: "CWE-798"
      owasp: "A07:2021 - Identification and Authentication Failures"
      confidence: HIGH
      references:
        - https://semgrep.dev/r/generic.secrets.security.detected-twitter-bearer-token

  # ============================================================================
  # LINEAR
  # ============================================================================
  - id: generic.secrets.security.linear-api-key
    languages: [generic]
    severity: ERROR
    message: "Linear API Key detected. Remove and rotate immediately."
    patterns:
      - "lin_api_[A-Za-z0-9]{40}"
    metadata:
      cwe: "CWE-798"
      owasp: "A07:2021 - Identification and Authentication Failures"
      confidence: HIGH
      references:
        - https://semgrep.dev/r/generic.secrets.security.detected-linear-api-key

  # ============================================================================
  # GITLAB
  # ============================================================================
  - id: generic.secrets.security.gitlab-token
    languages: [generic]
    severity: ERROR
    message: "GitLab Token detected. Remove and revoke immediately."
    patterns:
      - "glpat-[A-Za-z0-9_-]{20}"
      - "glptt-[A-Za-z0-9_-]{40}"
    metadata:
      cwe: "CWE-798"
      owasp: "A07:2021 - Identification and Authentication Failures"
      confidence: HIGH
      references:
        - https://semgrep.dev/r/generic.secrets.security.detected-gitlab-token

  # ============================================================================
  # BITBUCKET
  # ============================================================================
  - id: generic.secrets.security.bitbucket-token
    languages: [generic]
    severity: ERROR
    message: "Bitbucket Token detected. Remove and revoke immediately."
    patterns:
      - "(?i)bitbucket[_-]?(token|api[_-]?key)\\s*[:=]\\s*[\"']?[A-Za-z0-9_-]{20,}[\"']?"
    metadata:
      cwe: "CWE-798"
      owasp: "A07:2021 - Identification and Authentication Failures"
      confidence: HIGH
      references:
        - https://semgrep.dev/r/generic.secrets.security.detected-bitbucket-token

  # ============================================================================
  # DATADOG
  # ============================================================================
  - id: generic.secrets.security.datadog-api-key
    languages: [generic]
    severity: ERROR
    message: "Datadog API Key detected. Remove and rotate immediately."
    patterns:
      - "(?i)datadog[_-]?(api[_-]?key|app[_-]?key)\\s*[:=]\\s*[\"']?[a-f0-9]{32}[\"']?"
    metadata:
      cwe: "CWE-798"
      owasp: "A07:2021 - Identification and Authentication Failures"
      confidence: HIGH
      references:
        - https://semgrep.dev/r/generic.secrets.security.detected-datadog-api-key
